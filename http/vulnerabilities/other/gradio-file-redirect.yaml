id: gradio-file-redirect

info:
  name: Gradio - Open Redirect
  author: neo-ai-engineer,DhiyaneshDk
  severity: low
  description: |
    An open redirect vulnerability in Gradio allows attackers to craft malicious URLs that redirect users to external, potentially harmful sites without proper validation.
  metadata:
    verified: true
    max-request: 2
    fofa-query: "Gradio"
  tags: gradio,redirect,vuln,oos

http:
  - method: GET
    path:
      - "{{BaseURL}}/gradio_api/file=http://example.com"
      - "{{BaseURL}}/file=http://example.com"

    stop-at-first-match: true
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)example\.com\/?(\/|[^.].*)?$'
